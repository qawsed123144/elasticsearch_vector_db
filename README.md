# ğŸ” Elasticsearch å‘é‡æœå°‹å¯¦ä½œ

ä½¿ç”¨ Elasticsearch 8.x å»ºç«‹ä¸­æ–‡å‘é‡è³‡æ–™åº«ç³»çµ±ï¼Œæ”¯æ´ embedding è½‰æ›ã€index å»ºç«‹ã€k-NN å‘é‡æŸ¥è©¢èˆ‡ demo çµæœè¼¸å‡ºã€‚

ğŸ“– åŸå§‹æ•™å­¸ç§»æ¤è‡ª GitBookï¼Œè©³è¦‹ `/docs` ç›®éŒ„ã€‚

---

## ğŸ’¡ å°ˆæ¡ˆç‰¹è‰²

- ä½¿ç”¨ [BAAI/bge-large-zh-v1.5](https://huggingface.co/BAAI/bge-large-zh-v1.5) æ¨¡å‹é€²è¡Œä¸­æ–‡èªæ„è½‰å‘é‡
- ä½¿ç”¨ Elasticsearch `dense_vector` èˆ‡ HNSW å»ºç«‹å‘é‡ç´¢å¼•
- ä½¿ç”¨ Docker å¿«é€Ÿéƒ¨ç½² Elasticsearch 8.5.0
- æä¾› `embed.py` å»ºç«‹æ¸¬è©¦è³‡æ–™èˆ‡æ‰¹æ¬¡åŒ¯å…¥
- æä¾› `search.py` æŸ¥è©¢ CLI å·¥å…·ï¼ˆæ”¯æ´èªæ„ç›¸ä¼¼åº¦æœå°‹ï¼‰
- æ•´åˆ k-NN æœå°‹èˆ‡å‘é‡ API æŸ¥è©¢

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

```bash
# å»ºç«‹è™›æ“¬ç’°å¢ƒ
python3 -m venv myvenv
source myvenv/bin/activate
pip install -r requirements.txt

# å•Ÿå‹• Elasticsearchï¼ˆéœ€å…ˆå®‰è£ Dockerï¼‰
docker-compose up -d

# å»ºç«‹è³‡æ–™ä¸¦åŒ¯å…¥å‘é‡
python embed.py

# åŸ·è¡ŒæŸ¥è©¢
./search.py é£›å¤©æ±½è»Š

```
## ğŸ§ª æŸ¥è©¢è¼¸å‡ºç¯„ä¾‹
```bash
$ ./search.py é£›å¤©æ±½è»Š
æœå°‹å®Œæˆï¼Œç‹€æ…‹ç¢¼ï¼š 200
=== æŸ¥è©¢æ–‡å­— ===
é£›å¤©æ±½è»Š
=== æœå°‹çµæœ ===
1. ç›¸ä¼¼åº¦åˆ†æ•¸: 0.7521
   id: 242
   title: å¾ç„¡äººé§•é§›åˆ°ç¾å¯¦ï¼šé€™ä¸å†åªæ˜¯å¹»æƒ³
   description: æœ¬å½±ç‰‡æ·±å…¥æ¢è¨ ç„¡äººé§•é§› çš„æ‡‰ç”¨èˆ‡æœªä¾†ç™¼å±•ã€‚
   genre: å–œåŠ‡
   cast: ['å°å‹å‹ƒé“å°¼', 'å‘¨æ˜Ÿé¦³']
   release_year: 2004
   views: 1006553
--------------------------------------------------
2. ç›¸ä¼¼åº¦åˆ†æ•¸: 0.7463
   id: 115
   title: å¾ç„¡äººé§•é§›åˆ°ç¾å¯¦ï¼šé€™ä¸å†åªæ˜¯å¹»æƒ³
   description: æœ¬å½±ç‰‡æ·±å…¥æ¢è¨ ç„¡äººé§•é§› çš„æ‡‰ç”¨èˆ‡æœªä¾†ç™¼å±•ã€‚
   genre: æ•™è‚²
   cast: ['ç‹åŠ›å®', 'å°å‹å‹ƒé“å°¼']
   release_year: 2012
   views: 2154329
